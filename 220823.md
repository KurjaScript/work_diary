### 站会汇报

昨天把列表页的进度条拖拽功能做了，今天是把列表页的适配做了。

### 今日完成工作



### 未完成工作



### 需要协调工作

列表页支持纯音频组件

1. 在 `nftList/index.vue` 的基础上中给 `NftCard/index.vue` 传入参数`is-audio=item.url_content_type ? true : false`，通过 `url_content_type` 字段来判断该数据是否为音频。

2. 然后在 `NftCard/index.vue` 文件中接收判断音频文件的参数 `isAudio: boolean`。列表页要展示三种形式的数据：视频、图片和音频，如果传入的数据为空，则展示默认样式。通过父组件传入的三个参数进行判断：

   ```ts
   interface Props {
     nftInfo: nftListItemObj
     isVideo: boolean
     isAudio: boolean
   }
   const props = withDefault(defineProps<Props>(), {
     isVideo: false,
     isAudio: false,
   })
   const { nftInfo, isVideo, isAudio } = toRefs(props)
   ```

3. 在 `NftCard/index` 加入判断音频模块

   ```vue
   <template v-else-if="isAudio">
     <nft-audio
         v-if="resolveAudioSuccess"
         ref="audioEle"
         cross-origin="anonymous"
         loop
         :src="nftInfo.animation_url"
         @error="handleResolveAudioError"
         @canplay="handleCanPlayAudio"
         ></nft-audio>
   </template>
   ```

   ```ts
   const audioEle = ref<HTMLAudioElement | null>(null)
   const resolveAudioSuccess = ref(true) // 解析 audio 是否成功
   const loadVideoCompleted = ref(false) // 加载video是否完成
   const handleResolveAudioError = () => {
     // 监听 audio 解析失败
     resolveAudioSuccess.value = false
     loadAudioCompleted.value = true
   }
   const handleCanPlayAudio = () => {
    	loadAudioCompleted.value = true
   }
   ```

4. 由于支持纯音频组件的动画效果与功能较复杂，且被复用，需要将其封装为一个公共组件。

   在之后的完善种需要注意，列表页并没有进度条，只需要一个播放按钮控制播放和暂停；在详情页，通过浮动显示播放进度，拖动进度条可播放对应的内容，暂停拖动图片不旋转，**播放拖动图片保持旋转**。

   播放纯音频组件随着屏幕宽度变化自适应，组件整体等比例缩放。

#### 



